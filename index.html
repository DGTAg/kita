<!doctype html>
<html>
<head>
    <title>Mobile Research Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/styles.css">
    <script src="cordova.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-mobile.js"></script>
    <script src="js/gps.js"></script>
    <script type="text/javascript">
    
    var pictureSource;   // picture source
    var destinationType; // sets the format of returned value
    
    // Wait for device API libraries to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // device APIs are available
    //
    function onDeviceReady() {
        navigator.geolocation.getCurrentPosition(onSuccess, onError);
        pictureSource=navigator.camera.PictureSourceType;
        destinationType=navigator.camera.DestinationType;
    }
    
    // onSuccess Geolocation
    //
    function onSuccess(position) {
        var element = document.getElementById('geolocation');
        element.innerHTML = 'Latitude: '           + position.coords.latitude              + '<br />' +
                            'Longitude: '          + position.coords.longitude             + '<br />' +
                            'Altitude: '           + position.coords.altitude              + '<br />' +
                            'Accuracy: '           + position.coords.accuracy              + '<br />' +
                            'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                            'Heading: '            + position.coords.heading               + '<br />' +
                            'Speed: '              + position.coords.speed                 + '<br />' +
                            'Timestamp: '          + position.timestamp                    + '<br />';
    }

    // onError Callback receives a PositionError object
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }
    
    function onPhotoDataSuccess(imageData) {
      // Uncomment to view the base64-encoded image data
      // console.log(imageData);

      // Get image handle
      //
      var smallImage = document.getElementById('smallImage');

      // Unhide image elements
      //
      smallImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      smallImage.src = "data:image/jpeg;base64," + imageData;
    }

    // Called when a photo is successfully retrieved
    //
    function onPhotoURISuccess(imageURI) {
      // Uncomment to view the image file URI
      // console.log(imageURI);

      // Get image handle
      //
      var largeImage = document.getElementById('largeImage');

      // Unhide image elements
      //
      largeImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      largeImage.src = imageURI;
    }

    // A button will call this function
    //
    function capturePhoto() {
      // Take picture using device camera and retrieve image as base64-encoded string
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
        destinationType: destinationType.DATA_URL });
    }

    // A button will call this function
    //
    function capturePhotoEdit() {
      // Take picture using device camera, allow edit, and retrieve image as base64-encoded string
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true,
        destinationType: destinationType.DATA_URL });
    }

    // A button will call this function
    //
    function getPhoto(source) {
      // Retrieve image file location from specified source
      navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50,
        destinationType: destinationType.FILE_URI,
        sourceType: source });
    }

    // Called if something bad happens.
    //
    function onFail(message) {
      alert('Failed because: ' + message);
    }
    
    function createGuid()
	{
	    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
	        var r = Math.random()*16|0, v = c === 'x' ? r : (r&0x3|0x8);
	        return v.toString(16);
	    });
	}


	    
    </script>
    
</head>
<body>

    <div data-role="page" id="home">
 
        <div data-role="header" data-theme="b">
            <h1>KITA research tool</h1>
        </div><!-- /header -->
 
        <div data-role="content">
            <a href="#newForm" data-transition="flip" data-role="button">New Form</a>
            <a href="#" data-role="button">Statistic</a>
            <a href="about.html" data-rel="dialog" data-role="button">About</a>
        </div><!-- /content -->
 
        <div data-role="footer" data-theme="c">
            <h4>ByteCentrix mobile solution</h4>
        </div><!-- /footer -->
 
    </div>
    
    <div data-role="page" id="newForm">
    
    	<div data-role="panel" id="qPanel">
    		<ul data-role="listview">
			    <li><a href="#">Q 1</a></li>
			    <li><a href="#">Q 2</a></li>
			    <li><a href="#">Q 3</a></li>
			    <li><a href="#">Q 4</a></li>
			    <li><a href="#">Q 5</a></li>
			</ul>
    	</div>
    
    	<div data-role="header" data-theme="c">
    		<a href="#home" data-icon="home" data-iconpos="notext">Home</a>
    		<h1>New Survey</h1>
    		<a href="#qPanel" data-icon="gear" class="ui-btn-right">Options</a>
    	</div>
    	
    	<div data-role="content">
        <form>
		    <ul data-role="listview" data-inset="true">
		    	
		        <li data-role="fieldcontain">
		            <label for="guid">Generated Survey Id:</label>
		            <h3 name="guid" id="guid">uhuhuh</h3>		        
		        </li>
		        <li data-role="fieldcontain">
		            <label for="name2">Survey Location:</label>
		            <h3 id="geolocation">Finding geolocation...</h3>		        
		        </li>
		        <li data-role="fieldcontain">
		            <label for="name2">Text Input:</label>
		            <input type="text" name="name2" id="name2" value="" data-clear-btn="true">
		        </li>
		        <li data-role="fieldcontain">
		            <label for="textarea2">Textarea:</label>
		        <textarea cols="40" rows="8" name="textarea2" id="textarea2"></textarea>
		        </li>
		        <li data-role="fieldcontain">
		            <label for="flip2">Flip switch:</label>
		            <select name="flip2" id="flip2" data-role="slider">
		                <option value="off">Off</option>
		                <option value="on">On</option>
		            </select>
		        </li>
		        <li data-role="fieldcontain">
		            <label for="slider2">Slider:</label>
		            <input type="range" name="slider2" id="slider2" value="0" min="0" max="100" data-highlight="true">
		        </li>
		        <li data-role="fieldcontain">
		            <label for="select-choice-a" class="select">Custom select menu:</label>
					<select name="select-choice-a" id="select-choice-a" data-native-menu="false">
					    <option>Custom menu example</option>
					    <option value="standard">Standard: 7 day</option>
					    <option value="rush">Rush: 3 days</option>
					    <option value="express">Express: next day</option>
					    <option value="overnight">Overnight</option>
					</select>
		        </li>
		        <li data-role="fieldcontain">
		        <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
    <img style="display:none;" id="largeImage" src="" />
		            <div class="ui-grid-a">
					    <div class="ui-block-a"><button id="camera" onclick="capturePhoto();">Camera</button></div>
					    <div class="ui-block-b"><button data-theme="d">Video</button></div>
					</div>   
			    </li>
		        <li class="ui-body ui-body-b">
		            <fieldset class="ui-grid-a">
		                    <div class="ui-block-a"><button type="submit" data-theme="d">Cancel</button></div>
		                    <div class="ui-block-b"><button type="submit" data-theme="a">Submit</button></div>
		            </fieldset>
		        </li>
		    </ul>
		</form>
        </div>
    	
    	<div data-role="footer" data-theme="c">
            <h4>ByteCentrix mobile solution</h4>
        </div><!-- /footer -->
    
    </div>
    
    <script type="text/javascript">
    	var guid = createGuid();
		var valGuid = document.getElementById('guid');
		valGuid.innerHTML = guid;
    </script>
    
</body>
</html>
